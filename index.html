<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Cartas de la Fortuna ‚Äî Arkana Games</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700;800&family=Inter:wght@400;500;600&family=Teko:wght@500;600&display=swap" rel="stylesheet">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    :root {
      --gold: #FFD700;
      --gold-dark: #C5A028;
      --gold-soft: #F4E4C1;
      --gold-accent: #FFF8DC;
      --burgundy: #800020;
      --burgundy-dark: #5C0011;
      --deep-red: #A52A2A;
      --christmas-red: #C41E3A;
      --dark-red: #8B0000;
      --cream: #FFF8F0;
      --white: #FFFFFF;
      --warm-beige: #F5E6D3;
      --ff-body: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      --ff-display: 'Cinzel', serif;
      --ff-ui: 'Teko', sans-serif;
    }

    body {
      font-family: var(--ff-body);
      background: 
        radial-gradient(1200px 700px at 50% -10%, rgba(255,215,0,.15), transparent 60%),
        radial-gradient(900px 600px at 80% 100%, rgba(196,30,58,.12), transparent 60%),
        linear-gradient(135deg, var(--burgundy-dark) 0%, var(--burgundy) 35%, var(--deep-red) 70%, var(--christmas-red) 100%);
      min-height: 100vh;
      color: var(--cream);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: clamp(1rem, 3vw, 2rem);
      overflow-x: hidden;
      position: relative;
    }

    /* Preloader */
    .preloader {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, var(--burgundy-dark) 0%, var(--burgundy) 50%, var(--christmas-red) 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }

    .preloader.hidden {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }

    .preloader-logo {
      max-width: clamp(120px, 30vw, 200px);
      height: auto;
      margin-bottom: clamp(2rem, 5vw, 3rem);
      animation: logoFloat 3s ease-in-out infinite;
      filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.6));
    }

    @keyframes logoFloat {
      0%, 100% { transform: translateY(0px) scale(1); }
      50% { transform: translateY(-15px) scale(1.05); }
    }

    .progress-bar-container {
      width: clamp(250px, 60vw, 400px);
      height: 12px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), inset 0 2px 10px rgba(0, 0, 0, 0.2);
      border: 2px solid var(--gold-dark);
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--gold-dark), var(--gold), var(--gold-dark));
      background-size: 200% 100%;
      border-radius: 20px;
      width: 0%;
      animation: loadProgress 2.5s ease-out forwards, shimmerBar 1.5s linear infinite;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
    }

    @keyframes loadProgress {
      0% { width: 0%; }
      100% { width: 100%; }
    }

    @keyframes shimmerBar {
      0% { background-position: 0% 50%; }
      100% { background-position: 200% 50%; }
    }

    .loading-text {
      margin-top: clamp(1rem, 3vw, 1.5rem);
      color: var(--gold);
      font-size: clamp(1rem, 3vw, 1.4rem);
      font-weight: 600;
      font-family: var(--ff-display);
      text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
      letter-spacing: 2px;
    }

    /* Sound Control */
    .sound-control {
      position: fixed;
      top: clamp(1rem, 3vw, 1.5rem);
      right: clamp(1rem, 3vw, 1.5rem);
      width: clamp(44px, 10vw, 60px);
      height: clamp(44px, 10vw, 60px);
      background: linear-gradient(135deg, var(--gold-dark), var(--gold));
      border: 3px solid var(--gold-accent);
      border-radius: 50%;
      font-size: clamp(1.2rem, 3vw, 1.8rem);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
    }

    .sound-control:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 30px rgba(255, 215, 0, 0.6);
    }

    .sound-control:active {
      transform: scale(0.95);
    }

    .sound-control.muted {
      background: linear-gradient(135deg, #666, #999);
      border-color: #aaa;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: clamp(1.5rem, 4vw, 3rem);
      max-width: 900px;
      width: 100%;
      z-index: 1;
    }

    .logo {
      max-width: clamp(120px, 25vw, 180px);
      height: auto;
      margin-bottom: clamp(1rem, 2vw, 1.5rem);
      filter: drop-shadow(0 4px 20px rgba(255, 215, 0, 0.5));
    }

    h1 {
      font-family: var(--ff-display);
      font-size: clamp(1.8rem, 6vw, 3.5rem);
      font-weight: 800;
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-accent) 50%, var(--gold) 100%);
      background-size: 200% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: shimmer 3s ease-in-out infinite;
      text-shadow: 0 0 40px rgba(255, 215, 0, 0.5);
      margin-bottom: clamp(0.8rem, 2vw, 1.2rem);
      line-height: 1.2;
    }

    @keyframes shimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .subtitle {
      color: var(--cream);
      font-size: clamp(0.95rem, 2.5vw, 1.2rem);
      font-weight: 500;
      line-height: 1.6;
      text-shadow: 0 2px 15px rgba(0, 0, 0, 0.5);
      max-width: 700px;
      margin: 0 auto;
    }

    /* Cards Container: 3 columnas fijas */
    .cards-container {
      display: grid;
      grid-template-columns: repeat(3, minmax(90px, 1fr));
      gap: clamp(1rem, 3vw, 2rem);
      justify-items: center;
      align-items: center;
      max-width: 600px;
      width: 100%;
      margin: clamp(2rem, 5vw, 3rem) auto;
      z-index: 1;
      padding: 0 clamp(0.4rem, 2vw, 0.8rem);
    }

    /* Card */
    .card {
      width: 100%;
      max-width: 160px;
      aspect-ratio: 2 / 3;
      perspective: 1000px;
      cursor: pointer;
      position: relative;
      transform-origin: center center;
    }

    .card.disabled {
      cursor: not-allowed;
      opacity: 0.6;
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.8s cubic-bezier(0.4, 0.0, 0.2, 1);
      transform-style: preserve-3d;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: clamp(12px, 2vw, 20px);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    }

    /* Sin movimiento en hover/active para que no baje */
    .card:hover:not(.flipped):not(.disabled),
    .card:active:not(.flipped):not(.disabled) {
      transform: none;
    }

    /* Card Back (Christmas themed) */
    .card-back {
      background: linear-gradient(135deg, var(--christmas-red) 0%, var(--deep-red) 100%);
      border: 4px solid var(--gold);
      position: relative;
      overflow: hidden;
    }

    .card-back::before {
      content: '';
      position: absolute;
      inset: 0;
      background: 
        repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.05) 10px, rgba(255,255,255,0.05) 20px),
        repeating-linear-gradient(-45deg, transparent, transparent 10px, rgba(255,255,255,0.05) 10px, rgba(255,255,255,0.05) 20px);
    }

    .card-back::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.15), transparent);
      animation: cardShine 4s infinite;
    }

    @keyframes cardShine {
      0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
      100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }

    .card-back-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: clamp(0.8rem, 2vw, 1.2rem);
      z-index: 2;
      position: relative;
    }

    .card-icon {
      font-size: clamp(3rem, 8vw, 5rem);
      filter: drop-shadow(0 4px 15px rgba(255, 255, 255, 0.4));
      animation: iconFloat 3s ease-in-out infinite;
    }

    @keyframes iconFloat {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-8px); }
    }

    /* Card Front (Prize revealed) */
    .card-front {
      background: linear-gradient(135deg, var(--burgundy-dark) 0%, var(--burgundy) 100%);
      border: 4px solid var(--gold);
      transform: rotateY(180deg);
      padding: clamp(1rem, 3vw, 1.5rem);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .card-front::before {
      content: '';
      position: absolute;
      inset: 0;
      background: 
        radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.1), transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(255, 215, 0, 0.1), transparent 50%);
    }

    .prize-emoji {
      font-size: clamp(2.5rem, 7vw, 4.5rem);
      margin-bottom: clamp(0.8rem, 2vw, 1.2rem);
      filter: drop-shadow(0 4px 12px rgba(255, 215, 0, 0.5));
      animation: prizeFloat 2s ease-in-out infinite;
      z-index: 1;
    }

    @keyframes prizeFloat {
      0%, 100% { transform: translateY(0px) scale(1); }
      50% { transform: translateY(-10px) scale(1.1); }
    }

    .prize-text {
      font-family: var(--ff-display);
      font-size: clamp(1rem, 2.5vw, 1.4rem);
      font-weight: 700;
      background: linear-gradient(135deg, var(--gold), var(--gold-accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      line-height: 1.4;
      z-index: 1;
      text-shadow: 0 2px 10px rgba(255, 215, 0, 0.3);
    }

    /* Instruction Text */
    .instruction-text {
      text-align: center;
      font-size: clamp(1rem, 2.5vw, 1.3rem);
      font-weight: 600;
      color: var(--gold-accent);
      margin-top: clamp(1.5rem, 3vw, 2rem);
      text-shadow: 0 2px 15px rgba(255, 215, 0, 0.5);
      animation: textPulse 2s ease-in-out infinite;
      z-index: 1;
    }

    @keyframes textPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.9);
      z-index: 10000;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(10px);
      animation: fadeIn 0.3s ease;
      padding: clamp(1rem, 3vw, 2rem);
    }

    .modal.active {
      display: flex;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-content {
      background: linear-gradient(135deg, var(--burgundy) 0%, var(--burgundy-dark) 100%);
      border: 4px solid var(--gold);
      border-radius: clamp(15px, 3vw, 25px);
      padding: clamp(2rem, 5vw, 3rem);
      max-width: 500px;
      width: 90%;
      text-align: center;
      position: relative;
      box-shadow: 0 20px 60px rgba(255, 215, 0, 0.4);
      animation: modalBounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    @keyframes modalBounce {
      0% { transform: scale(0.3) rotate(-10deg); opacity: 0; }
      50% { transform: scale(1.05) rotate(2deg); }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }

    .modal-close {
      position: absolute;
      top: clamp(10px, 2vw, 15px);
      right: clamp(10px, 2vw, 15px);
      background: rgba(255, 215, 0, 0.2);
      border: 2px solid var(--gold);
      color: var(--gold-accent);
      font-size: clamp(1.5rem, 3vw, 2rem);
      width: clamp(40px, 8vw, 50px);
      height: clamp(40px, 8vw, 50px);
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      font-weight: 700;
    }

    .modal-close:hover {
      background: var(--gold);
      color: var(--burgundy-dark);
      transform: rotate(90deg);
    }

    .modal-title {
      font-family: var(--ff-display);
      font-size: clamp(1.5rem, 4vw, 2.2rem);
      color: var(--gold);
      font-weight: 700;
      margin-bottom: clamp(1rem, 3vw, 1.5rem);
      text-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
    }

    .modal-prize-details {
      margin: clamp(1.5rem, 4vw, 2rem) 0;
    }

    .modal-prize-emoji {
      font-size: clamp(4rem, 10vw, 6rem);
      margin-bottom: clamp(1rem, 3vw, 1.5rem);
      filter: drop-shadow(0 4px 20px rgba(255, 215, 0, 0.6));
      animation: modalPrizeFloat 2s ease-in-out infinite;
    }

    @keyframes modalPrizeFloat {
      0%, 100% { transform: translateY(0px) scale(1); }
      50% { transform: translateY(-15px) scale(1.15); }
    }

    .modal-prize-text {
      font-family: var(--ff-display);
      font-size: clamp(1.5rem, 4vw, 2.5rem);
      font-weight: 800;
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-accent) 50%, var(--gold) 100%);
      background-size: 200% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: shimmer 2s ease-in-out infinite;
      margin-bottom: clamp(1rem, 3vw, 1.5rem);
      line-height: 1.3;
    }

    .modal-message {
      color: var(--cream);
      font-size: clamp(1rem, 2.5vw, 1.2rem);
      line-height: 1.7;
      margin-top: clamp(1rem, 3vw, 1.5rem);
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }

    .modal-button {
      margin-top: clamp(1.5rem, 4vw, 2rem);
      padding: clamp(0.8rem, 2vw, 1rem) clamp(2rem, 5vw, 3rem);
      background: linear-gradient(135deg, var(--gold-dark), var(--gold));
      border: 3px solid var(--gold-accent);
      border-radius: 50px;
      color: var(--burgundy-dark);
      font-family: var(--ff-ui);
      font-size: clamp(1.1rem, 3vw, 1.4rem);
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
      letter-spacing: 1px;
    }

    .modal-button:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 30px rgba(255, 215, 0, 0.6);
    }

    .modal-button:active {
      transform: scale(0.98);
    }

    /* Success Message */
    .success-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(135deg, var(--burgundy) 0%, var(--burgundy-dark) 100%);
      border: 4px solid var(--gold);
      border-radius: clamp(15px, 3vw, 25px);
      padding: clamp(2rem, 5vw, 3rem);
      max-width: 500px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(255, 215, 0, 0.5);
      z-index: 10001;
      display: none;
      animation: successBounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .success-message.active {
      display: block;
    }

    @keyframes successBounce {
      0% { transform: translate(-50%, -50%) scale(0.3); opacity: 0; }
      50% { transform: translate(-50%, -50%) scale(1.05); }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }

    .success-title {
      font-family: var(--ff-display);
      font-size: clamp(1.5rem, 4vw, 2rem);
      color: var(--gold);
      font-weight: 700;
      margin-bottom: clamp(1rem, 3vw, 1.5rem);
      text-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
    }

    .success-prize {
      font-size: clamp(3rem, 8vw, 5rem);
      margin: clamp(1rem, 3vw, 1.5rem) 0;
      filter: drop-shadow(0 4px 20px rgba(255, 215, 0, 0.6));
    }

    .success-text {
      font-family: var(--ff-display);
      font-size: clamp(1.2rem, 3vw, 1.8rem);
      font-weight: 700;
      background: linear-gradient(135deg, var(--gold), var(--gold-accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      line-height: 1.4;
    }

    /* Confetti */
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      pointer-events: none;
      z-index: 9999;
      animation: confettiFall linear forwards;
    }

    @keyframes confettiFall {
      0% {
        transform: translateY(-100vh) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }

    /* Snowflakes */
    .snowflake {
      position: fixed;
      top: -10px;
      color: rgba(255, 255, 255, 0.8);
      font-size: clamp(10px, 2vw, 20px);
      pointer-events: none;
      z-index: 0;
      animation: snowfall linear infinite;
    }

    @keyframes snowfall {
      0% {
        transform: translateY(-10px) translateX(0);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) translateX(50px);
        opacity: 0.3;
      }
    }

    /* Responsive Ajustes */
    @media (max-width: 768px) {
      .cards-container {
        max-width: 480px;
        gap: 1rem;
      }

      .card {
        max-width: 140px;
      }
    }

    @media (max-width: 480px) {
      .cards-container {
        grid-template-columns: repeat(3, minmax(80px, 1fr));
        max-width: 100%;
        padding: 0 0.25rem;
        gap: 0.8rem;
      }

      .card {
        max-width: 110px;
      }

      h1 {
        font-size: 1.8rem;
      }

      .subtitle {
        font-size: 0.9rem;
      }
    }

    @media (max-width: 360px) {
      .cards-container {
        grid-template-columns: repeat(3, minmax(70px, 1fr));
        gap: 0.6rem;
      }

      .card {
        max-width: 95px;
      }

      .card-icon {
        font-size: 2.5rem;
      }
    }

    @media (max-height: 600px) and (orientation: landscape) {
      body {
        padding: 1rem 2rem;
      }

      .header {
        margin-bottom: 1rem;
      }

      .logo {
        max-width: 100px;
        margin-bottom: 0.5rem;
      }

      h1 {
        font-size: 1.8rem;
        margin-bottom: 0.5rem;
      }

      .subtitle {
        font-size: 0.9rem;
      }

      .cards-container {
        margin: 1rem auto;
        gap: 1rem;
      }

      .card {
        max-width: 130px;
      }

      .instruction-text {
        margin-top: 1rem;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>

  <!-- Preloader -->
  <div class="preloader" id="preloader">
    <img src="assets/image.png" alt="Arkana Games" class="preloader-logo">
    <div class="progress-bar-container">
      <div class="progress-bar"></div>
    </div>
    <div class="loading-text">Cargando cartas...</div>
  </div>

  <!-- Sound Control -->
  <button class="sound-control" id="soundControl" aria-label="Control de sonido">
    üîä
  </button>

  <!-- Header -->
  <div class="header">
    <img src="assets/image.png" alt="Arkana Games" class="logo">
    <h1>Cartas de la Fortuna</h1>
    <p class="subtitle">Eleg√≠ una de las 3 cartas m√°gicas y descubr√≠ tu premio especial del d√≠a. ¬°La suerte est√° de tu lado!</p>
  </div>

  <!-- Cards Container -->
  <div class="cards-container" id="cardsContainer"></div>

  <!-- Instruction Text -->
  <p class="instruction-text" id="instructionText">
    ‚ú® Hac√© clic en cualquier carta para revelar tu premio ‚ú®
  </p>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <button class="modal-close" id="modalClose">‚úï</button>
      <div class="modal-title">üéâ ¬°Felicitaciones! üéâ</div>
      <div class="modal-prize-details">
        <div class="modal-prize-emoji" id="modalPrizeEmoji">üíé</div>
        <div class="modal-prize-text" id="modalPrizeText">¬°Has ganado!</div>
      </div>
      <div class="modal-message" id="modalMessage">Tu premio te est√° esperando. ¬°Volv√© ma√±ana para otra oportunidad!</div>
      <button class="modal-button" id="modalButton">¬°Reclamar Premio!</button>
    </div>
  </div>

  <!-- Success Message -->
  <div class="success-message" id="successMessage">
    <div class="success-title">¬°Felicitaciones!</div>
    <div class="success-prize" id="successPrizeEmoji">üéÅ</div>
    <div class="success-text" id="successPrizeText">Conseguiste el 150%</div>
  </div>

  <script>
    // Premios con probabilidades
    const prizes = [
      { text: 'Bono del 100%', emoji: 'üéÅ', weight: 35 },
      { text: 'Bono del 150%', emoji: 'üéâ', weight: 30 },
      { text: 'Bono del 200%', emoji: 'üíé', weight: 20 },
      { text: 'Bono Sorpresa', emoji: 'üéä', weight: 10 },
      { text: 'Bono a elecci√≥n', emoji: '‚ú®', weight: 5 }
    ];

    // Weighted random prize selection
    function getWeightedRandomPrize() {
      const totalWeight = prizes.reduce((sum, prize) => sum + prize.weight, 0);
      let random = Math.random() * totalWeight;
      
      for (let prize of prizes) {
        if (random < prize.weight) {
          return prize;
        }
        random -= prize.weight;
      }
      return prizes[0];
    }

    // DOM Elements
    const preloader = document.getElementById('preloader');
    const cardsContainer = document.getElementById('cardsContainer');
    const instructionText = document.getElementById('instructionText');
    const modal = document.getElementById('modal');
    const modalClose = document.getElementById('modalClose');
    const modalPrizeEmoji = document.getElementById('modalPrizeEmoji');
    const modalPrizeText = document.getElementById('modalPrizeText');
    const modalMessage = document.getElementById('modalMessage');
    const modalButton = document.getElementById('modalButton');
    const successMessage = document.getElementById('successMessage');
    const successPrizeEmoji = document.getElementById('successPrizeEmoji');
    const successPrizeText = document.getElementById('successPrizeText');
    const soundControl = document.getElementById('soundControl');

    // Audio (usando archivos locales en /assets)
    const backgroundMusic = new Audio('assets/background-music.mp3');
    backgroundMusic.loop = true;
    backgroundMusic.volume = 0.3;

    const flipSound = new Audio('assets/flip.mp3');
    flipSound.volume = 0.5;

    const congratsSound = new Audio('assets/prize-sound.mp3');
    congratsSound.volume = 0.6;

    let isMuted = false;
    let hasPlayed = false;
    let selectedCardIndex = null;
    let wonPrize = null;

    // Check if already played today
    function checkIfPlayedToday() {
      const savedData = localStorage.getItem('arkanaCardsGame');
      if (savedData) {
        const data = JSON.parse(savedData);
        const today = new Date().toDateString();
        if (data.date === today) {
          hasPlayed = true;
          selectedCardIndex = data.cardIndex;
          wonPrize = data.prize;
          return true;
        }
      }
      return false;
    }

    // Generate cards
    function generateCards() {
      cardsContainer.innerHTML = '';
      
      for (let i = 0; i < 3; i++) {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.index = i;

        if (hasPlayed && i !== selectedCardIndex) {
          card.classList.add('disabled');
        }

        if (hasPlayed && i === selectedCardIndex) {
          card.classList.add('flipped');
        }

        const prize = hasPlayed && i === selectedCardIndex ? wonPrize : getWeightedRandomPrize();

        card.innerHTML = `
          <div class="card-inner">
            <div class="card-face card-back">
              <div class="card-back-content">
                <div class="card-icon">üéÑ</div>
              </div>
            </div>
            <div class="card-face card-front">
              <div class="prize-emoji">${prize.emoji}</div>
              <div class="prize-text">${prize.text}</div>
            </div>
          </div>
        `;

        card.addEventListener('click', () => selectCard(i, prize));
        cardsContainer.appendChild(card);
      }

      if (hasPlayed) {
        instructionText.textContent = '';
      }
    }

    // Select card
    function selectCard(index, prize) {
      const card = document.querySelectorAll('.card')[index];

      if (hasPlayed && index === selectedCardIndex) {
        showSuccessMessage();
        return;
      }

      if (hasPlayed && index !== selectedCardIndex) {
        return;
      }

      if (card.classList.contains('flipped')) return;

      if (!isMuted) {
        flipSound.currentTime = 0;
        flipSound.play().catch(e => console.log('Error playing flip sound:', e));
      }

      card.classList.add('flipped');
      selectedCardIndex = index;
      wonPrize = prize;

      document.querySelectorAll('.card').forEach((c, i) => {
        if (i !== index) {
          c.classList.add('disabled');
        }
      });

      const today = new Date().toDateString();
      localStorage.setItem('arkanaCardsGame', JSON.stringify({
        date: today,
        cardIndex: index,
        prize: prize
      }));
      hasPlayed = true;

      instructionText.textContent = '‚ú® Clicke√° tu carta para ver tu premio nuevamente ‚ú®';

      setTimeout(() => {
        showPrizeModal();
        createConfetti();
        if (!isMuted) {
          congratsSound.play().catch(e => console.log('Error playing congrats sound:', e));
        }
      }, 1000);
    }

    // Show prize modal
    function showPrizeModal() {
      modalPrizeEmoji.textContent = wonPrize.emoji;
      modalPrizeText.textContent = wonPrize.text;
      modal.classList.add('active');
    }

    // Show success message (when clicking card again)
    function showSuccessMessage() {
      successPrizeEmoji.textContent = wonPrize.emoji;
      successPrizeText.textContent = `Conseguiste ${wonPrize.text}`;
      successMessage.classList.add('active');
      
      if (!isMuted) {
        congratsSound.currentTime = 0;
        congratsSound.play().catch(e => console.log('Error playing congrats sound:', e));
      }

      setTimeout(() => {
        successMessage.classList.remove('active');
      }, 3000);
    }

    // Create confetti
    function createConfetti() {
      const colors = ['#FFD700', '#FFA500', '#FF6347', '#FF69B4', '#87CEEB', '#98FB98'];
      const confettiCount = 120;

      for (let i = 0; i < confettiCount; i++) {
        setTimeout(() => {
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = Math.random() * 100 + 'vw';
          confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
          confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
          confetti.style.animationDelay = '0s';
          document.body.appendChild(confetti);

          setTimeout(() => confetti.remove(), 5000);
        }, i * 15);
      }
    }

    function createSnowflakes() {
      // Menos copos en pantallas chicas
      const isMobile = window.matchMedia('(max-width: 768px)').matches;
      const SNOWFLAKE_COUNT = isMobile ? 10 : 25;  // ajust√° los n√∫meros si quer√©s

      for (let i = 0; i < SNOWFLAKE_COUNT; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        snowflake.textContent = '‚ùÑ';

        snowflake.style.left = Math.random() * 100 + 'vw';
        snowflake.style.animationDuration = (Math.random() * 8 + 7) + 's'; // 7‚Äì15s
        snowflake.style.animationDelay = Math.random() * 8 + 's';
        snowflake.style.fontSize = (Math.random() * 6 + 10) + 'px';

        document.body.appendChild(snowflake);
      }
    }

    // Close modal
    modalClose.addEventListener('click', () => {
      modal.classList.remove('active');
    });

    modalButton.addEventListener('click', () => {
      modal.classList.remove('active');
    });

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.classList.remove('active');
      }
    });

    // Sound control
    soundControl.addEventListener('click', () => {
      isMuted = !isMuted;
      soundControl.textContent = isMuted ? 'üîá' : 'üîä';
      soundControl.classList.toggle('muted');

      if (isMuted) {
        backgroundMusic.pause();
      } else {
        backgroundMusic.play().catch(e => console.log('Error playing background music:', e));
      }
    });

    // Initialize game
    function initGame() {
      checkIfPlayedToday();
      generateCards();
      createSnowflakes();

      setTimeout(() => {
        if (!isMuted) {
          backgroundMusic.play().catch(e => {
            document.body.addEventListener('click', () => {
              if (!isMuted) {
                backgroundMusic.play().catch(err => console.log('Error playing music:', err));
              }
            }, { once: true });
          });
        }
      }, 1000);
    }

    // Hide preloader and start game
    setTimeout(() => {
      preloader.classList.add('hidden');
      initGame();
    }, 2800);
  </script>
</body>
</html>
